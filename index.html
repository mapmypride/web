<!DOCTYPE html>
<html>
<head>
    <title>MapMyPride - LGBTQ+ Safe Spaces</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Essential Libraries -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.158.0/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js"></script>

    <!-- Initialize Firebase -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDh-YgTP_uqqWafy7G-AhiaGM_ToDa3XS8",
            authDomain: "mapmypride-384b4.firebaseapp.com",
            databaseURL: "https://mapmypride-384b4-default-rtdb.firebaseio.com",
            projectId: "mapmypride-384b4",
            storageBucket: "mapmypride-384b4.firebasestorage.app",
            messagingSenderId: "141472779467",
            appId: "1:141472779467:web:60e48c11bfa040036cdf4e"
        };
        firebase.initializeApp(firebaseConfig);
    </script>    <style>        /* Pride Events Sub-Buttons Fix */
        .event-button,
        .event-card,
        .event-action-button {
            padding: 20px 40px;
            font-size: 1.4rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            margin: 10px;
        }

        .event-button:hover,
        .event-card:hover,
        .event-action-button:hover {
            transform: translateY(-5px);
            background: linear-gradient(
                45deg,
                #ff0000,
                #ff8000,
                #ffff00,
                #00ff00,
                #00ffff,
                #0000ff,
                #8000ff,
                #ff00ff
            );
            background-size: 200% auto;
            animation: gradient-shift 3s linear infinite;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        /* Form Sizing Fix */
        .modal-content,
        .form-container {
            max-width: 90%;
            width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            margin: 20px auto;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
        }

        /* Form Elements Sizing */
        .form-group {
            margin-bottom: 20px;
            width: 100%;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            margin-top: 5px;
        }

        textarea.form-control {
            min-height: 100px;
            max-height: 200px;
            resize: vertical;
        }

        /* Modal Positioning */
        .modal {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* Scrollbar Styling */
        .modal-content::-webkit-scrollbar,
        .form-container::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track,
        .form-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .modal-content::-webkit-scrollbar-thumb,
        .form-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .modal-content,
            .form-container {
                width: 95%;
                padding: 20px;
            }

            .event-button,
            .event-card,
            .event-action-button {
                padding: 15px 30px;
                font-size: 1.2rem;
            }

            .form-control {
                padding: 10px;
                font-size: 0.9rem;
            }
        }
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --primary: #FF458A;
            --secondary: #7928CA;
            --accent: #00D4FF;
            --background: #1A1A1A;
            --card: #252525;
            --text: #FFFFFF;
            --gradient: linear-gradient(135deg, 
                #FF0000 0%, 
                #FF8D00 20%, 
                #FFEE00 40%, 
                #00FF00 60%, 
                #00FFFF 80%, 
                #A200FF 100%
            );
        }

        body {
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Page Transitions */
        .page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: var(--background);
            padding: 20px;
            overflow-y: auto;
            z-index: 1001;
            animation: pageFadeIn 0.3s ease-out;
        }

        /* Home Page */
        .home {
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1f3f 100%);
        }

        /* Navigation */
        .nav-buttons, .feature-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
            width: 90%;
            max-width: 600px;
        }

        .nav-button, .feature-button {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1rem;
        }

        .nav-button:hover, .feature-button:hover {
            background: var(--gradient);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Floating Elements */
        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .float-element {
            position: absolute;
            background: var(--gradient);
            border-radius: 50%;
            filter: blur(20px);
            opacity: 0.15;
            animation: float 20s infinite;
            z-index: 1;
        }

        /* Particles */
        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }

        .particle {
            width: 4px;
            height: 4px;
            background: var(--gradient);
            border-radius: 50%;
            position: absolute;
            animation: particleFloat 10s infinite linear;
        }

        /* Map Controls */
        .map-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .control-button {
            width: 45px;
            height: 45px;
            background: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            animation: modalFadeIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--card);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Forms */
        input, textarea, select {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
        }

        /* Buttons */
        .add-button {
            padding: 12px 25px;
            background: var(--gradient);
            border: none;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .add-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(10px, -10px); }
            50% { transform: translate(-5px, 5px); }
            75% { transform: translate(-10px, -5px); }
        }

        @keyframes particleFloat {
            0% { 
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% { opacity: 0.5; }
            100% {
                transform: translateY(-100px) scale(1);
                opacity: 0;
            }
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pageFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-buttons, .feature-buttons {
                grid-template-columns: 1fr;
            }

            .title {
                font-size: 3rem;
            }
        }
            /* Page Headers */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .page-title {
            font-size: 2rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Content Container */
        .content-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Category Tabs */
        .resources-categories, .tips-categories {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            margin-bottom: 20px;
        }

        .category-tab {
            padding: 10px 20px;
            background: var(--card);
            border: none;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .category-tab.active {
            background: var(--gradient);
        }

        /* Grid Layouts */
        .events-grid, .resources-grid, .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px 0;
        }

        /* Cards */
        .event-card, .resource-card, .tip-card {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .event-card:hover, .resource-card:hover, .tip-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* Community Chat */
        .community-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            height: calc(100vh - 100px);
            padding: 20px;
        }

        .chat-groups {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
        }

        .groups-list {
            margin-top: 20px;
            overflow-y: auto;
            max-height: calc(100% - 60px);
        }

        .chat-messages {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .messages-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            margin-bottom: 20px;
        }

        .message {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            max-width: 80%;
        }

        .message.sent {
            margin-left: auto;
            background: var(--primary);
        }

        .message-input {
            display: flex;
            gap: 10px;
        }

        .message-input input {
            flex-grow: 1;
        }

        .message-input button {
            padding: 10px;
            background: var(--primary);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Type Options */
        .type-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }

        .type-button {
            padding: 10px;
            background: var(--card);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .type-button.selected {
            background: var(--gradient);
        }

        /* Safety Rating */
        .safety-rating {
            margin: 15px 0;
        }

        .rating-stars {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }

        .star {
            color: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .star.active {
            color: #FFD700;
        }

        /* Map Styles */
        #map {
            width: 100%;
            height: 100vh;
            z-index: 1;
        }

        .leaflet-popup-content-wrapper {
            background: var(--card);
            color: var(--text);
        }

        .leaflet-popup-tip {
            background: var(--card);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .community-container {
                grid-template-columns: 1fr;
            }

            .chat-groups {
                height: auto;
            }

            .type-options {
                grid-template-columns: repeat(2, 1fr);
            }

            .page-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }        /* Category Selection Fixes */
        .category-item, .type-button, .category-tab {
            background: var(--card);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.1rem;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .category-item:hover, .type-button:hover, .category-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-color: var(--primary);
        }

        .category-item.selected, .type-button.selected, .category-tab.active {
            background: var(--gradient);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Bigger Title */
        .app-title {
            font-size: 8rem !important;
            font-weight: 900;
            text-align: center;
            background: linear-gradient(
                45deg,
                #ff0000,
                #ff8d00,
                #ffee00,
                #00ff00,
                #00fff2,
                #0040ff,
                #8000ff,
                #ff00ff
            );
            background-size: 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rainbow-title 8s linear infinite;
            margin: 40px 0;
            line-height: 1.2;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
        }

        /* Bigger and More Fun Buttons */
        .main-button, .feature-button {
            padding: 20px 35px;
            font-size: 1.3rem;
            margin: 15px;
            border-radius: 30px;
            background: var(--gradient);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            transform-origin: center;
            animation: button-pulse 2s infinite;
        }

        @keyframes button-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .main-button:hover, .feature-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* Fix Map Controls Overlap */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: var(--card);
            padding: 15px 25px;
            border-radius: 25px;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .leaflet-control-zoom {
            margin-top: 80px !important;
        }

        /* Location Categories Grid */
        .location-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }        /* Updated Epic Rainbow Title and Animations */
        .title-container {
            position: relative;
            margin-bottom: 30px;
            z-index: 2;
        }

        .title {
            font-size: 4.5rem !important;
            font-weight: 900;
            text-align: center;
            background: linear-gradient(
                to right,
                #ff0000,
                #ff8000,
                #ffff00,
                #00ff00,
                #00ffff,
                #0000ff,
                #8000ff,
                #ff00ff
            );
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: rainbow-flow 8s linear infinite;
            margin: 0;
            padding: 40px 0;
            line-height: 1;
            text-shadow: 0 0 50px rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 2;
        }

        .subtitle {
            font-size: 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            margin-top: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        /* Updated Button Styling */
        .nav-button {
            padding: 25px 50px;
            font-size: 1.8rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
        }

        .nav-button:hover {
            transform: translateY(-5px);
            background: linear-gradient(
                45deg,
                #ff0000,
                #ff8000,
                #ffff00,
                #00ff00,
                #00ffff,
                #0000ff,
                #8000ff,
                #ff00ff
            );
            background-size: 200% auto;
            animation: gradient-shift 3s linear infinite;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        /* Updated Animations */
        @keyframes rainbow-flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Updated Mobile Responsiveness */
        @media (max-width: 768px) {
            .title {
                font-size: 3rem !important;
            }
            
            .nav-button {
                padding: 20px 40px;
                font-size: 1.4rem;
            }
        }</style>
</head>
</head><body>
    <div class="container">
        <!-- Home Page -->
        <div class="home" id="homePage">
            <!-- Floating Elements -->
            <div class="floating-elements" id="floatingElements"></div>
            
            <!-- Rainbow Particles -->
            <div class="particles" id="particles"></div>

            <!-- Main Content -->
            <div class="title-container">
                <h1 class="title">MapMyPride</h1>
                <p class="subtitle">Discover & Share LGBTQ+ Friendly Spaces</p>
            </div>

            <!-- Main Navigation -->
            <div class="nav-buttons">
                <button class="nav-button" onclick="showMap()">
                    <span class="material-icons-round">map</span>
                    Explore Map
                </button>
                <button class="nav-button" onclick="showSpots()">
                    <span class="material-icons-round">place</span>
                    LGBTQ+ Spots
                </button>
            </div>

            <!-- Feature Buttons -->
            <div class="feature-buttons">
                <button class="feature-button" onclick="showEvents()">
                    <span class="material-icons-round">event</span>
                    Pride Events
                </button>
                <button class="feature-button" onclick="showResources()">
                    <span class="material-icons-round">library_books</span>
                    Resources
                </button>
                <button class="feature-button" onclick="showCommunity()">
                    <span class="material-icons-round">forum</span>
                    Community
                </button>
                <button class="feature-button" onclick="showSafetyTips()">
                    <span class="material-icons-round">security</span>
                    Safety Tips
                </button>
            </div>

            <!-- User Account -->
            <div class="user-section">
                <button class="nav-button" id="authButton" onclick="showAuthModal()">
                    <span class="material-icons-round">person</span>
                    Sign In
                </button>
            </div>
        </div>

        <!-- Map Page -->
        <div class="page" id="mapPage">
            <div class="map-controls">
                <button class="control-button" onclick="showHome()">
                    <span class="material-icons-round">arrow_back</span>
                </button>
                <button class="control-button" onclick="filterLocations()">
                    <span class="material-icons-round">filter_list</span>
                </button>
                <button class="control-button" onclick="showSpots()">
                    <span class="material-icons-round">view_list</span>
                </button>
            </div>
            <div id="map"></div>
            <button class="add-button" onclick="showAddLocationModal()">
                <span class="material-icons-round">add_location</span>
                Add Location
            </button>
        </div>

        <!-- Auth Modal -->
        <div class="modal" id="authModal">
            <div class="modal-content">
                <h2 id="authTitle">Sign In</h2>
                <div id="authForm">
                    <input type="email" id="authEmail" placeholder="Email" required>
                    <input type="password" id="authPassword" placeholder="Password" required>
                    <div class="auth-buttons">
                        <button class="modal-button" onclick="toggleAuthMode()">
                            <span id="authToggleText">New? Create Account</span>
                        </button>
                        <button class="modal-button primary" onclick="handleAuth()">
                            <span id="authSubmitText">Sign In</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Location Modal -->
        <div class="modal" id="addLocationModal">
            <div class="modal-content">
                <h2>Add New Safe Space</h2>
                <div class="category-grid">
                    <div class="category-item" data-category="restaurant">
                        <span class="material-icons-round">restaurant</span>
                        <p>Restaurant</p>
                    </div>
                    <div class="category-item" data-category="bar">
                        <span class="material-icons-round">local_bar</span>
                        <p>Bar</p>
                    </div>
                    <div class="category-item" data-category="cafe">
                        <span class="material-icons-round">coffee</span>
                        <p>Cafe</p>
                    </div>
                    <div class="category-item" data-category="health">
                        <span class="material-icons-round">local_hospital</span>
                        <p>Healthcare</p>
                    </div>
                    <div class="category-item" data-category="community">
                        <span class="material-icons-round">people</span>
                        <p>Community</p>
                    </div>
                    <div class="category-item" data-category="shopping">
                        <span class="material-icons-round">shopping_bag</span>
                        <p>Shopping</p>
                    </div>
                </div>

                <input type="text" id="locationName" placeholder="Location Name" required>
                <textarea id="locationDescription" placeholder="Tell us about this place..." rows="3"></textarea>
                <input type="text" id="locationAddress" placeholder="Address" required>
                
                <div class="safety-rating">
                    <p>Safety Rating</p>
                    <div class="rating-stars">
                        <span class="material-icons-round star" data-rating="1">star</span>
                        <span class="material-icons-round star" data-rating="2">star</span>
                        <span class="material-icons-round star" data-rating="3">star</span>
                        <span class="material-icons-round star" data-rating="4">star</span>
                        <span class="material-icons-round star" data-rating="5">star</span>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button class="modal-button" onclick="closeModal('addLocationModal')">Cancel</button>
                    <button class="modal-button primary" onclick="saveLocation()">Add Location</button>
                </div>
            </div>
        </div>        <!-- Pride Events Page -->
        <div class="page" id="eventsPage">
            <div class="page-header">
                <h2 class="page-title">Pride Events</h2>
                <button class="back-button" onclick="showHome()">
                    <span class="material-icons-round">arrow_back</span>
                    Back
                </button>
            </div>
            <div class="content-container">
                <div class="filters">
                    <button class="filter-button active" data-filter="all">All Events</button>
                    <button class="filter-button" data-filter="upcoming">Upcoming</button>
                    <button class="filter-button" data-filter="past">Past</button>
                </div>
                <button class="add-button" onclick="showAddEventModal()">
                    <span class="material-icons-round">add</span>
                    Add Event
                </button>
                <div class="events-grid" id="eventsGrid"></div>
            </div>
        </div>

        <!-- Add Event Modal -->
        <div class="modal" id="addEventModal">
            <div class="modal-content">
                <h2>Create Pride Event</h2>
                <input type="text" id="eventName" placeholder="Event Name" required>
                <input type="text" id="eventVenue" placeholder="Venue" required>
                <input type="text" id="eventAddress" placeholder="Address" required>
                <input type="date" id="eventDate" required>
                <input type="time" id="eventTime" required>
                <textarea id="eventDescription" placeholder="Event Description" rows="3" required></textarea>
                <input type="text" id="eventContact" placeholder="Contact Information">
                <div class="event-type">
                    <label>Event Type:</label>
                    <div class="type-options">
                        <button class="type-button" data-type="parade">Pride Parade</button>
                        <button class="type-button" data-type="festival">Festival</button>
                        <button class="type-button" data-type="workshop">Workshop</button>
                        <button class="type-button" data-type="social">Social</button>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="modal-button" onclick="closeModal('addEventModal')">Cancel</button>
                    <button class="modal-button primary" onclick="saveEvent()">Create Event</button>
                </div>
            </div>
        </div>

        <!-- Resources Page -->
        <div class="page" id="resourcesPage">
            <div class="page-header">
                <h2 class="page-title">LGBTQ+ Resources</h2>
                <button class="back-button" onclick="showHome()">
                    <span class="material-icons-round">arrow_back</span>
                    Back
                </button>
            </div>
            <div class="content-container">
                <div class="resources-categories">
                    <button class="category-tab active" data-category="education">Educational</button>
                    <button class="category-tab" data-category="health">Healthcare</button>
                    <button class="category-tab" data-category="legal">Legal</button>
                    <button class="category-tab" data-category="scholarships">Scholarships</button>
                    <button class="category-tab" data-category="support">Support Groups</button>
                </div>
                <button class="add-button" onclick="showAddResourceModal()">
                    <span class="material-icons-round">add</span>
                    Add Resource
                </button>
                <div class="resources-grid" id="resourcesGrid"></div>
            </div>
        </div>

        <!-- Add Resource Modal -->
        <div class="modal" id="addResourceModal">
            <div class="modal-content">
                <h2>Add Resource</h2>
                <input type="text" id="resourceTitle" placeholder="Resource Title" required>
                <select id="resourceCategory" required>
                    <option value="">Select Category</option>
                    <option value="education">Educational</option>
                    <option value="health">Healthcare</option>
                    <option value="legal">Legal</option>
                    <option value="scholarships">Scholarships</option>
                    <option value="support">Support Groups</option>
                </select>
                <textarea id="resourceDescription" placeholder="Resource Description" rows="3" required></textarea>
                <input type="url" id="resourceLink" placeholder="Resource Link (Optional)">
                <div class="resource-type">
                    <label>Resource Type:</label>
                    <div class="type-options">
                        <button class="type-button" data-type="article">Article</button>
                        <button class="type-button" data-type="video">Video</button>
                        <button class="type-button" data-type="document">Document</button>
                        <button class="type-button" data-type="website">Website</button>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="modal-button" onclick="closeModal('addResourceModal')">Cancel</button>
                    <button class="modal-button primary" onclick="saveResource()">Add Resource</button>
                </div>
            </div>
        </div>

        <!-- Community Page -->
        <div class="page" id="communityPage">
            <div class="page-header">
                <h2 class="page-title">Community Forum</h2>
                <button class="back-button" onclick="showHome()">
                    <span class="material-icons-round">arrow_back</span>
                    Back
                </button>
            </div>
            <div class="community-container">
                <div class="chat-groups">
                    <button class="add-button" onclick="showCreateGroupModal()">
                        <span class="material-icons-round">group_add</span>
                        Create Group
                    </button>
                    <div class="groups-list" id="groupsList"></div>
                </div>
                <div class="chat-messages">
                    <div class="messages-container" id="messagesContainer"></div>
                    <div class="message-input">
                        <input type="text" id="messageInput" placeholder="Type your message...">
                        <button onclick="sendMessage()">
                            <span class="material-icons-round">send</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Group Modal -->
        <div class="modal" id="createGroupModal">
            <div class="modal-content">
                <h2>Create Chat Group</h2>
                <input type="text" id="groupName" placeholder="Group Name" required>
                <textarea id="groupDescription" placeholder="Group Description" rows="3" required></textarea>
                <div class="group-type">
                    <label>Group Type:</label>
                    <div class="type-options">
                        <button class="type-button" data-type="social">Social</button>
                        <button class="type-button" data-type="support">Support</button>
                        <button class="type-button" data-type="activism">Activism</button>
                        <button class="type-button" data-type="interests">Interests</button>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button class="modal-button" onclick="closeModal('createGroupModal')">Cancel</button>
                    <button class="modal-button primary" onclick="createGroup()">Create Group</button>
                </div>
            </div>
        </div>

        <!-- Safety Tips Page -->
        <div class="page" id="safetyTipsPage">
            <div class="page-header">
                <h2 class="page-title">Safety Tips</h2>
                <button class="back-button" onclick="showHome()">
                    <span class="material-icons-round">arrow_back</span>
                    Back
                </button>
            </div>
            <div class="content-container">
                <div class="tips-categories">
                    <button class="category-tab active" data-category="personal">Personal Safety</button>
                    <button class="category-tab" data-category="online">Online Safety</button>
                    <button class="category-tab" data-category="travel">Travel Safety</button>
                    <button class="category-tab" data-category="emergency">Emergency</button>
                </div>
                <button class="add-button" onclick="showAddTipModal()">
                    <span class="material-icons-round">add</span>
                    Share a Tip
                </button>
                <div class="tips-grid" id="tipsGrid"></div>
            </div>
        </div>

        <!-- Add Safety Tip Modal -->
        <div class="modal" id="addTipModal">
            <div class="modal-content">
                <h2>Share Safety Tip</h2>
                <input type="text" id="tipTitle" placeholder="Tip Title" required>
                <select id="tipCategory" required>
                    <option value="">Select Category</option>
                    <option value="personal">Personal Safety</option>
                    <option value="online">Online Safety</option>
                    <option value="travel">Travel Safety</option>
                    <option value="emergency">Emergency</option>
                </select>
                <textarea id="tipDescription" placeholder="Share your safety tip..." rows="3" required></textarea>
                <div class="modal-buttons">
                    <button class="modal-button" onclick="closeModal('addTipModal')">Cancel</button>
                    <button class="modal-button primary" onclick="saveTip()">Share Tip</button>
                </div>
            </div>
        </div>
    </div>    <script>
        // Initialize variables
        let map;
        let currentMarker;
        let selectedCategory = null;
        let selectedRating = 0;
        let currentUser = null;
        const db = firebase.database();
        const auth = firebase.auth();
        const storage = firebase.storage();

        // Authentication Functions
        function showAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function toggleAuthMode() {
            const isSignIn = document.getElementById('authTitle').textContent === 'Sign In';
            document.getElementById('authTitle').textContent = isSignIn ? 'Create Account' : 'Sign In';
            document.getElementById('authToggleText').textContent = isSignIn ? 'Already have an account?' : 'New? Create Account';
            document.getElementById('authSubmitText').textContent = isSignIn ? 'Sign Up' : 'Sign In';
        }

        function handleAuth() {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const isSignIn = document.getElementById('authTitle').textContent === 'Sign In';

            if (isSignIn) {
                auth.signInWithEmailAndPassword(email, password)
                    .then(handleAuthSuccess)
                    .catch(handleAuthError);
            } else {
                auth.createUserWithEmailAndPassword(email, password)
                    .then(handleAuthSuccess)
                    .catch(handleAuthError);
            }
        }

        function handleAuthSuccess(userCredential) {
            currentUser = userCredential.user;
            document.getElementById('authModal').classList.remove('active');
            updateAuthButton();
        }

        function handleAuthError(error) {
            alert('Authentication error: ' + error.message);
        }

        function updateAuthButton() {
            const authButton = document.getElementById('authButton');
            if (currentUser) {
                authButton.innerHTML = `
                    <span class="material-icons-round">person</span>
                    Sign Out
                `;
                authButton.onclick = () => auth.signOut();
            } else {
                authButton.innerHTML = `
                    <span class="material-icons-round">person</span>
                    Sign In
                `;
                authButton.onclick = showAuthModal;
            }
        }

        // Map Functions
        function initMap() {
            map = L.map('map').setView([0, 0], 2);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const { latitude, longitude } = position.coords;
                    map.setView([latitude, longitude], 13);
                });
            }

            loadLocations();

            map.on('click', (e) => {
                if (!currentUser) {
                    alert('Please sign in to add locations');
                    return;
                }
                if (currentMarker) {
                    map.removeLayer(currentMarker);
                }
                currentMarker = L.marker(e.latlng).addTo(map);
                showAddLocationModal();
            });
        }

        // Navigation Functions
        function showMap() {
            hideAllPages();
            document.getElementById('mapPage').style.display = 'block';
            if (!map) {
                initMap();
            }
        }

        function showHome() {
            hideAllPages();
            document.getElementById('homePage').style.display = 'flex';
        }

        function showEvents() {
            hideAllPages();
            document.getElementById('eventsPage').style.display = 'block';
            loadEvents();
        }

        function showResources() {
            hideAllPages();
            document.getElementById('resourcesPage').style.display = 'block';
            loadResources();
        }

        function showCommunity() {
            if (!currentUser) {
                alert('Please sign in to access the community features');
                return;
            }
            hideAllPages();
            document.getElementById('communityPage').style.display = 'block';
            loadGroups();
        }

        function showSafetyTips() {
            hideAllPages();
            document.getElementById('safetyTipsPage').style.display = 'block';
            loadSafetyTips();
        }

        function hideAllPages() {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.style.display = 'none');
        }

        // Modal Functions
        function showAddLocationModal() {
            document.getElementById('addLocationModal').classList.add('active');
        }

        function showAddEventModal() {
            if (!currentUser) {
                alert('Please sign in to add events');
                return;
            }
            document.getElementById('addEventModal').classList.add('active');
        }

        function showAddResourceModal() {
            if (!currentUser) {
                alert('Please sign in to add resources');
                return;
            }
            document.getElementById('addResourceModal').classList.add('active');
        }

        function showCreateGroupModal() {
            if (!currentUser) {
                alert('Please sign in to create groups');
                return;
            }
            document.getElementById('createGroupModal').classList.add('active');
        }

        function showAddTipModal() {
            if (!currentUser) {
                alert('Please sign in to share safety tips');
                return;
            }
            document.getElementById('addTipModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            if (currentMarker && modalId === 'addLocationModal') {
                map.removeLayer(currentMarker);
                currentMarker = null;
            }
        }

        // Save Functions
        function saveLocation() {
            if (!currentUser || !currentMarker || !selectedCategory) return;

            const name = document.getElementById('locationName').value;
            const description = document.getElementById('locationDescription').value;
            const address = document.getElementById('locationAddress').value;
            const position = currentMarker.getLatLng();

            const newLocation = {
                name,
                description,
                address,
                category: selectedCategory,
                safety_rating: selectedRating,
                position: {
                    lat: position.lat,
                    lng: position.lng
                },
                userId: currentUser.uid,
                timestamp: Date.now()
            };

            db.ref('locations').push(newLocation)
                .then(() => {
                    closeModal('addLocationModal');
                    loadLocations();
                })
                .catch(error => console.error('Error saving location:', error));
        }

        function saveEvent() {
            if (!currentUser) return;

            const event = {
                name: document.getElementById('eventName').value,
                venue: document.getElementById('eventVenue').value,
                address: document.getElementById('eventAddress').value,
                date: document.getElementById('eventDate').value,
                time: document.getElementById('eventTime').value,
                description: document.getElementById('eventDescription').value,
                contact: document.getElementById('eventContact').value,
                userId: currentUser.uid,
                timestamp: Date.now()
            };

            db.ref('events').push(event)
                .then(() => {
                    closeModal('addEventModal');
                    loadEvents();
                })
                .catch(error => console.error('Error saving event:', error));
        }

        function saveResource() {
            if (!currentUser) return;

            const resource = {
                title: document.getElementById('resourceTitle').value,
                category: document.getElementById('resourceCategory').value,
                description: document.getElementById('resourceDescription').value,
                link: document.getElementById('resourceLink').value,
                userId: currentUser.uid,
                timestamp: Date.now()
            };

            db.ref('resources').push(resource)
                .then(() => {
                    closeModal('addResourceModal');
                    loadResources();
                })
                .catch(error => console.error('Error saving resource:', error));
        }

        function saveTip() {
            if (!currentUser) return;

            const tip = {
                title: document.getElementById('tipTitle').value,
                category: document.getElementById('tipCategory').value,
                description: document.getElementById('tipDescription').value,
                userId: currentUser.uid,
                timestamp: Date.now()
            };

            db.ref('tips').push(tip)
                .then(() => {
                    closeModal('addTipModal');
                    loadSafetyTips();
                })
                .catch(error => console.error('Error saving tip:', error));
        }

        // Load Functions
        function loadLocations() {
            db.ref('locations').on('value', (snapshot) => {
                map.eachLayer((layer) => {
                    if (layer instanceof L.Marker) {
                        map.removeLayer(layer);
                    }
                });

                snapshot.forEach((childSnapshot) => {
                    const location = childSnapshot.val();
                    const locationKey = childSnapshot.key;
                    const marker = L.marker([
                        location.position.lat,
                        location.position.lng
                    ]).addTo(map);

                    const deleteButton = location.userId === (currentUser?.uid || '') ?
                        `<button class="popup-button delete" onclick="deleteLocation('${locationKey}')">
                            <span class="material-icons-round">delete</span> Delete
                        </button>` : '';

                    const popupContent = `
                        <div class="popup-content">
                            <h3>${location.name}</h3>
                            <p>${location.description}</p>
                            <p><strong>Address:</strong> ${location.address}</p>
                            <div class="category-tag">${location.category}</div>
                            <div class="safety-rating">
                                ${'⭐'.repeat(location.safety_rating || 0)}
                            </div>
                            ${deleteButton}
                        </div>
                    `;
                    marker.bindPopup(popupContent);
                });
            });
        }

        function loadEvents() {
            const eventsGrid = document.getElementById('eventsGrid');
            eventsGrid.innerHTML = '';

            db.ref('events').on('value', (snapshot) => {
                snapshot.forEach((childSnapshot) => {
                    const event = childSnapshot.val();
                    const eventKey = childSnapshot.key;
                    const canDelete = event.userId === (currentUser?.uid || '');

                    const eventCard = document.createElement('div');
                    eventCard.className = 'event-card';
                    eventCard.innerHTML = `
                        <h3>${event.name}</h3>
                        <p><strong>Venue:</strong> ${event.venue}</p>
                        <p><strong>Address:</strong> ${event.address}</p>
                        <p><strong>Date:</strong> ${event.date}</p>
                        <p><strong>Time:</strong> ${event.time}</p>
                        <p>${event.description}</p>
                        <p><strong>Contact:</strong> ${event.contact}</p>
                        ${canDelete ? `
                            <button class="popup-button delete" onclick="deleteEvent('${eventKey}')">
                                <span class="material-icons-round">delete</span> Delete
                            </button>
                        ` : ''}
                    `;
                    eventsGrid.appendChild(eventCard);
                });
            });
        }

        function loadResources() {
            const resourcesGrid = document.getElementById('resourcesGrid');
            resourcesGrid.innerHTML = '';

            db.ref('resources').on('value', (snapshot) => {
                snapshot.forEach((childSnapshot) => {
                    const resource = childSnapshot.val();
                    const resourceKey = childSnapshot.key;
                    const canDelete = resource.userId === (currentUser?.uid || '');

                    const resourceCard = document.createElement('div');
                    resourceCard.className = 'resource-card';
                    resourceCard.innerHTML = `
                        <h3>${resource.title}</h3>
                        <div class="category-tag">${resource.category}</div>
                        <p>${resource.description}</p>
                        ${resource.link ? `
                            <a href="${resource.link}" target="_blank" class="resource-link">
                                <span class="material-icons-round">link</span> View Resource
                            </a>
                        ` : ''}
                        ${canDelete ? `
                            <button class="popup-button delete" onclick="deleteResource('${resourceKey}')">
                                <span class="material-icons-round">delete</span> Delete
                            </button>
                        ` : ''}
                    `;
                    resourcesGrid.appendChild(resourceCard);
                });
            });
        }

        function loadSafetyTips() {
            const tipsGrid = document.getElementById('tipsGrid');
            tipsGrid.innerHTML = '';

            db.ref('tips').on('value', (snapshot) => {
                snapshot.forEach((childSnapshot) => {
                    const tip = childSnapshot.val();
                    const tipKey = childSnapshot.key;
                    const canDelete = tip.userId === (currentUser?.uid || '');

                    const tipCard = document.createElement('div');
                    tipCard.className = 'tip-card';
                    tipCard.innerHTML = `
                        <h3>${tip.title}</h3>
                        <div class="category-tag">${tip.category}</div>
                        <p>${tip.description}</p>
                        ${canDelete ? `
                            <button class="popup-button delete" onclick="deleteTip('${tipKey}')">
                                <span class="material-icons-round">delete</span> Delete
                            </button>
                        ` : ''}
                    `;
                    tipsGrid.appendChild(tipCard);
                });
            });
        }

        // Delete Functions
        function deleteLocation(locationKey) {
            if (confirm('Are you sure you want to delete this location?')) {
                db.ref('locations/' + locationKey).remove()
                    .then(() => loadLocations())
                    .catch(error => console.error('Error deleting location:', error));
            }
        }

        function deleteEvent(eventKey) {
            if (confirm('Are you sure you want to delete this event?')) {
                db.ref('events/' + eventKey).remove()
                    .then(() => loadEvents())
                    .catch(error => console.error('Error deleting event:', error));
            }
        }

        function deleteResource(resourceKey) {
            if (confirm('Are you sure you want to delete this resource?')) {
                db.ref('resources/' + resourceKey).remove()
                    .then(() => loadResources())
                    .catch(error => console.error('Error deleting resource:', error));
            }
        }

        function deleteTip(tipKey) {
            if (confirm('Are you sure you want to delete this tip?')) {
                db.ref('tips/' + tipKey).remove()
                    .then(() => loadSafetyTips())
                    .catch(error => console.error('Error deleting tip:', error));
            }
        }

        // Initialize animations
        function createFloatingElements() {
            const container = document.getElementById('floatingElements');
            container.innerHTML = '';
            
            for (let i = 0; i < 8; i++) {
                const element = document.createElement('div');
                element.className = 'float-element';
                element.style.width = Math.random() * 200 + 100 + 'px';
                element.style.height = element.style.width;
                element.style.left = Math.random() * 100 + '%';
                element.style.top = Math.random() * 100 + '%';
                element.style.animationDelay = `-${Math.random() * 20}s`;
                container.appendChild(element);
            }
        }

        function createParticles() {
            const container = document.getElementById('particles');
            container.innerHTML = '';
            
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                container.appendChild(particle);
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            createFloatingElements();
            createParticles();        // Location Categories
        const locationCategories = [
            { id: 'cafe', name: 'Café', icon: '☕' },
            { id: 'restaurant', name: 'Restaurant', icon: '🍽️' },
            { id: 'bar', name: 'Bar', icon: '🍸' },
            { id: 'club', name: 'Club', icon: '🎉' },
            { id: 'shop', name: 'Shop', icon: '🛍️' },
            { id: 'healthcare', name: 'Healthcare', icon: '⚕️' },
            { id: 'community', name: 'Community Center', icon: '🏳️‍🌈' },
            { id: 'other', name: 'Other', icon: '📍' }
        ];

        function initializeLocationCategories() {
            const categoriesContainer = document.querySelector('.location-categories');
            categoriesContainer.innerHTML = locationCategories.map(category => `
                <button class="category-item" data-category="${category.id}">
                    <span class="category-icon">${category.icon}</span>
                    ${category.name}
                </button>
            `).join('');

            // Add click handlers
            document.querySelectorAll('.category-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.category-item').forEach(i => 
                        i.classList.remove('selected'));
                    item.classList.add('selected');
                    selectedCategory = item.dataset.category;
                });
            });
        }

        // Call this in your DOMContentLoaded event
        document.addEventListener('DOMContentLoaded', () => {
            // ... existing code ...
            initializeLocationCategories();
        });

            // Category selection
            document.querySelectorAll('.category-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.category-item').forEach(i => 
                        i.classList.remove('selected'));
                    item.classList.add('selected');
                    selectedCategory = item.dataset.category;
                });
            });

            // Rating selection
            document.querySelectorAll('.rating-stars .star').forEach(star => {
                star.addEventListener('click', () => {
                    const rating = parseInt(star.dataset.rating);
                    selectedRating = rating;
                    document.querySelectorAll('.rating-stars .star').forEach(s => {
                        if (parseInt(s.dataset.rating) <= rating) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });

            // Auth state changes
            auth.onAuthStateChanged(user => {
                currentUser = user;
                updateAuthButton();
            });
        });
    </script>
</body>
</html>